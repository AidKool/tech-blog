<main class="section px-4">
  <section class="container">
    <div class="card">
      {{> card-partial}}
    </div>
    {{#if loggedIn}}
    <p class='add-comment has-text-link has-text-weight-bold mt-3'>Add a comment</p>
    <div class="comment-form-container mt-3">
      <form class="comment-form">
        <label for="comment">Post your comment</label>
        <textarea name="comment" id="comment"></textarea>
        <button class="button is-link" type="submit">Submit</button>
        <button class='button is-danger cancel-btn'>Cancel</button>
      </form>
    </div>
    {{else}}
    <p class="mt-3">
      <a href="/signup">Sign up</a> or <a href="/login">log in</a> to post a comment
    </p>
    {{/if}}
    <p class="mb-3 mt-3 subtitle">Latest Replies:</p>
    <ul>
      {{#each this.comments}}
      <li>
        <div class="card mb-3">
          <header class="card-header py-2 px-3 is-size-7 has-background-grey is-flex is-justify-content-space-between">
            <p class="has-text-black has-text-weight-bold">
              <span class="has-text-white has-text-weight-bold">{{this.user.username}}</span> replied
            </p>
            <p class="has-text-weight-bold has-text-black">
              {{#if updated}}
              Updated {{format_date updatedAt}}
              {{else}}
              Posted {{format_date createdAt}}
              {{/if}}
              ago</p>
          </header>
          <div class="card-content py-2 px-3">
            <p>{{this.content}}</p>
          </div>
        </div>
      </li>
      {{/each}}
    </ul>
  </section>
</main>
{{#if loggedIn}}
<script src="/js/comments.js"></script>
{{/if}}